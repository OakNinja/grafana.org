<!DOCTYPE html><html><head><meta charset="utf-8" /><!--Always force latest IE rendering engine or request Chrome Frame--><meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" /><!--Use title if it's in the page YAML frontmatter--><title>Grafana Documentation</title><link href="/stylesheets/all.css" media="screen" rel="stylesheet" type="text/css" /><script src="/javascripts/all.js" type="text/javascript"></script></head><body class="docs docs_query_language docs_query_language_index"><section class="nav"><div class="row"><nav class="top-bar hide-for-small"><ul class="title-area"><li class="name"><a href="/"><img src="/images/influxdb-light-24px.png" /></a></li></ul><li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li><section class="top-bar-section"><ul class="right"><li class="divider"></li><li><a href="/overview">Overview</a></li><li class="divider"></li><li><a href="/docs">Docs</a></li><li class="divider"></li><li><a href="/blog">Blog</a></li><li class="divider"></li><li><a href="/community">Community</a></li><li class="divider"></li><li class="has-form"><a class="button" href="/download">Download</a></li></ul></section></nav></div></section><section role="main"><div class="row"><div class="large-4 medium-4 columns"><div class="sidebar"><nav><ul class="side-nav"><li class="heading">Getting Started</li><li><a href="/docs">Introduction</a></li><li class="divider"></li><li class="heading">Installation</li><li><a href="/docs/api/http.html">HTTP API</a></li><li><a href="/docs/api/protobuf.html">Protobuf API</a></li><li class="divider"></li><li class="heading">Dashboards</li><li><a href="/docs/query_language/">Overview</a></li><li><a href="/docs/query_language/functions.html">Functions</a></li><li><a href="/docs/query_language/continuous_queries.html">Continuous Queries</a></li><li class="divider"></li><li class="heading">Graph editor</li><li><a href="/docs/interfaces/">Overview</a></li><li><a href="/docs/interfaces/custom.html">Custom Interfaces</a></li><li class="divider"></li><li class="heading">Annotations</li><li><a href="/docs/libraries/javascript.html">JavaScript</a></li></ul></nav><a class="button download expand" href="/download" style="margin-bottom: 0;">Download Grafana</a></div></div><div class="large-8 medium-8 columns"><h1>Overview</h1>

<p>InfluxDB features a SQL like query language, only used for querying data. The HTTP API has endpoints for writing data and performing other database administration tasks. The only exception to this is <a href="/docs/query_language/continuous_queries.html">continuous queries</a>, which perpetually write their results into one or more time series.</p>

<p>The <a href="/docs">getting started section</a> has some example queries. This section will cover all of the available functions and provide some examples.</p>

<h2>Changes to the query language in v0.4.0</h2>

<p>Starting with version 0.4.0 the equality and inequality operators was
changed to <code>=</code> and <code>&lt;&gt;</code> from <code>==</code> and <code>!=</code>, respectively.</p>

<h2>Select and Time Ranges</h2>

<p>By default, InfluxDB returns data in time descending order. The most efficient queries run over only a single column in a given time series.</p>
<pre class="highlight sql"><span class="k">select</span> <span class="n">value</span> <span class="k">from</span> <span class="n">response_times</span><span class="p">;</span>
</pre>
<p>This simple query pulls the values for the <code>value</code> column from the <code>response_times</code> series.</p>

<h3>Older versions</h3>

<p>Prior to version 0.4.0, InfluxDB will apply some limits to the number of points and the time range. Without those arguments specified, the previous query would actually get converted to:</p>
<pre class="highlight sql"><span class="k">select</span> <span class="n">value</span> <span class="k">from</span> <span class="n">response_times</span> <span class="k">where</span> <span class="n">time</span> <span class="o">&gt;</span> <span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="n">h</span> <span class="k">limit</span> <span class="mi">1000</span><span class="p">;</span>
</pre>
<p>The default is to limit the time range to an hour or the last 1000 points, whichever comes first.</p>

<h3>How to set query start and end time</h3>

<p>If start and end times aren&rsquo;t set they will default to beginning of
time until now, respectively.</p>

<p>The column <code>time</code> is built in for every time series in the
database. You specify the start and end times by setting conditions on
the <code>time</code> columns in the where clause.</p>

<p>Below are the different formats that can be used to specify start and
end times.</p>

<h4>Date time strings</h4>

<p>Date time strings have the format <code>YYYY-MM-DD HH:MM:SS.mmm</code> where
<code>mmm</code> are the milliseconds within the second. For example:</p>
<pre class="highlight sql"><span class="k">select</span> <span class="n">value</span> <span class="k">from</span> <span class="n">response_times</span>
<span class="k">where</span> <span class="n">time</span> <span class="o">&gt;</span> <span class="s1">&#39;2013-08-12 23:32:01.232&#39;</span> <span class="k">and</span> <span class="n">time</span> <span class="o">&lt;</span> <span class="s1">&#39;2013-08-13&#39;</span><span class="p">;</span>
</pre>
<p>The time and date should be wrapped in single quotes. If you only
specify the date, the time will be set to <code>00:00:00</code>. The <code>.232</code> after
the hours, minutes, and seconds is optional and specifies the
milliseconds.</p>

<h4>Relative time</h4>

<p>You can use <code>now()</code> to calculate a timestamp relative to the server&rsquo;s
current timestamp. For example:</p>
<pre class="highlight sql"><span class="k">select</span> <span class="n">value</span> <span class="k">from</span> <span class="n">response_times</span> <span class="k">where</span> <span class="n">time</span> <span class="o">&gt;</span> <span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="n">h</span> <span class="k">limit</span> <span class="mi">1000</span><span class="p">;</span>
</pre>
<p>will return all points starting an hour ago until now.</p>

<p>Other options for how to specify time durations are <code>u</code> for
microseconds, <code>s</code> for seconds, <code>m</code> for minutes, <code>h</code> for hours, ,<code>d</code>
for days and <code>w</code> for weeks. If no suffix is given the value is
interpreted as nanoseconds.</p>

<h4>Absolute time</h4>

<p>You can specify timestamp in epoch time, which is defined as the
number of nanoseconds that have elapsed since 00:00:00 Coordinated
Universal Time (UTC), Thursday, 1 January 1970. You can use the same
suffixes from the previous section if you don&rsquo;t want to specify
timestamp in nanoseconds. For example:</p>
<pre class="highlight sql"><span class="k">select</span> <span class="n">value</span> <span class="k">from</span> <span class="n">response_times</span> <span class="k">where</span> <span class="n">time</span> <span class="o">&gt;</span> <span class="mi">1388534400</span><span class="n">s</span>
</pre>
<p>will return all points that were writtern after <code>2014-01-01 00:00:00</code></p>

<h3>Selecting a Specific Point</h3>

<p>Points are uniquely identified by the time series they appear in, the time, and the sequence number. Here&rsquo;s a query that returns a specific point.</p>
<pre class="highlight sql"><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">events</span> <span class="k">where</span> <span class="n">time</span> <span class="o">=</span> <span class="mi">1383154176</span> <span class="k">and</span> <span class="n">sequence_number</span> <span class="o">=</span> <span class="mi">2321</span><span class="p">;</span>
</pre>
<p>This was implemented in v0.4.0.</p>

<h3>Selecting Multiple Series</h3>

<p>You can select from multiple series by name or by specifying a regex to match against. Here are a few examples.</p>
<pre class="highlight sql"><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">events</span><span class="p">,</span> <span class="n">errors</span><span class="p">;</span>
</pre>
<p>Get the last hour of data from the two series <code>events</code>, and <code>errors</code>. Here&rsquo;s a regex example:</p>
<pre class="highlight sql"><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="o">/</span><span class="n">stats</span><span class="err">\</span><span class="p">..</span><span class="o">*/</span><span class="n">i</span><span class="p">;</span>
</pre>
<p>Get the last hour of data from every time series that starts with <code>stats.</code> (case insensitive). Another example:</p>
<pre class="highlight sql"><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="o">/</span><span class="p">.</span><span class="o">*/</span> <span class="k">limit</span> <span class="mi">1</span><span class="p">;</span>
</pre>
<p>Return the last point from every time series in the database.</p>

<h2>Deleting data</h2>

<p>The delete query looks like the following:</p>

<p><code>delete from response_times where time &gt; now() - 1h</code></p>

<p>With no time constraints this query will delete every point in the
time series <code>response_times</code>. You have to be a db admin in order to be
able to delete data from timeseries.</p>

<p>Any conditions in the where clause that don&rsquo;t set the start and/or end
time will be ignored, for example the following query:</p>

<p><code>delete from response_times where user = &#39;foo&#39;</code></p>

<p>will return an error.</p>

<h2>The Where Clause</h2>

<p>We&rsquo;ve already seen the where clause for selecting time ranges and a specific point. You can also use it to filter based on given values, comparators, or regexes. Here are some examples of different ways to use <em>where</em>.</p>
<pre class="highlight sql"><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">events</span> <span class="k">where</span> <span class="k">state</span> <span class="o">=</span> <span class="s1">&#39;NY&#39;</span><span class="p">;</span>

<span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">log_lines</span> <span class="k">where</span> <span class="n">line</span> <span class="o">=~</span> <span class="o">/</span><span class="n">error</span><span class="o">/</span><span class="n">i</span><span class="p">;</span>

<span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">events</span> <span class="k">where</span> <span class="n">customer_id</span> <span class="o">=</span> <span class="mi">23</span> <span class="k">and</span> <span class="k">type</span> <span class="o">=</span> <span class="s1">&#39;click&#39;</span><span class="p">;</span>

<span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">response_times</span> <span class="k">where</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="mi">500</span><span class="p">;</span>

<span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">events</span> <span class="k">where</span> <span class="n">email</span> <span class="o">!~</span> <span class="o">/</span><span class="p">.</span><span class="o">*</span><span class="n">gmail</span><span class="p">.</span><span class="o">*/</span><span class="p">;</span>

<span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">nagios_checks</span> <span class="k">where</span> <span class="n">status</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span><span class="p">;</span>

<span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">events</span> <span class="k">where</span> <span class="n">signed_in</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>

<span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">events</span> 
<span class="k">where</span> <span class="p">(</span><span class="n">email</span> <span class="o">=~</span> <span class="o">/</span><span class="p">.</span><span class="o">*</span><span class="n">gmail</span><span class="p">.</span><span class="o">*</span> <span class="k">or</span> <span class="n">email</span> <span class="o">=~</span> <span class="o">/</span><span class="p">.</span><span class="o">*</span><span class="n">yahoo</span><span class="p">.</span><span class="o">*/</span><span class="p">)</span> <span class="k">and</span> <span class="k">state</span> <span class="o">=</span> <span class="s1">&#39;ny&#39;</span><span class="p">;</span>
</pre>
<p>The where clause supports comparisons against regexes, strings, booleans, floats, integers, and the times listed before. Comparators include <code>=</code> equal to, <code>&gt;</code> greater than, <code>&lt;</code> less than, <code>&lt;&gt;</code> not equal to, <code>=~</code> matches against, <code>!~</code> doesn&rsquo;t match against. You can chain logic together using <code>and</code> and <code>or</code> and you can separate using <code>(</code> and <code>)</code></p>

<p><strong>Note:</strong> Boolean matching was introduced in version 0.5.3.</p>

<h2>Group By</h2>

<p>The group by clause in InfluxDB is used not only for grouping by given values, but also for grouping by given time buckets. You&rsquo;ll always be pairing this up with <a href="/docs/query_language/functions.html">a function</a> in the <code>select</code> clause. Here are a few examples to illustrate how group by works.</p>
<pre class="highlight sql"><span class="c1">-- count of events in 10 minute intervals
</span><span class="k">select</span> <span class="k">count</span><span class="p">(</span><span class="k">type</span><span class="p">)</span> <span class="k">from</span> <span class="n">events</span> <span class="k">group</span> <span class="k">by</span> <span class="n">time</span><span class="p">(</span><span class="mi">10</span><span class="n">m</span><span class="p">);</span>

<span class="c1">-- count of each unique type of event in 10 minute intervals
</span><span class="k">select</span> <span class="k">count</span><span class="p">(</span><span class="k">type</span><span class="p">)</span> <span class="k">from</span> <span class="n">events</span> <span class="k">group</span> <span class="k">by</span> <span class="n">time</span><span class="p">(</span><span class="mi">10</span><span class="n">m</span><span class="p">),</span> <span class="k">type</span><span class="p">;</span>

<span class="c1">-- 95th percentile of response times in 30 second intervals
</span><span class="k">select</span> <span class="n">percentile</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">95</span><span class="p">)</span> <span class="k">from</span> <span class="n">response_times</span> <span class="k">group</span> <span class="k">by</span> <span class="n">time</span><span class="p">(</span><span class="mi">30</span><span class="n">s</span><span class="p">);</span>
</pre>
<p>By default functions will output a column that have the same name as the function, e.g. <code>count</code> will output a column with the name <code>count</code> in order to change the name of the column an <code>AS</code> clause is required. Here is an example to illustrate how aliasing work:</p>
<pre class="highlight sql"><span class="k">select</span> <span class="k">count</span><span class="p">(</span><span class="k">type</span><span class="p">)</span> <span class="k">as</span> <span class="n">number_of_types</span> <span class="k">group</span> <span class="k">by</span> <span class="n">time</span><span class="p">(</span><span class="mi">10</span><span class="n">m</span><span class="p">);</span>
</pre>
<p>The time function takes the time interval which can be in
microseconds, milliseconds, seconds, minutes or hours. To specify the
units you can use the respective suffix <code>us</code>, <code>ms</code>, <code>s</code>, <code>m</code> and <code>h</code>.</p>

<h2>Merging Series</h2>

<p>You can merge multiple time series into a single stream in the select clause. This is helpful when you want to run a function over one of the columns with an associated group by time clause.</p>
<pre class="highlight sql"><span class="k">select</span> <span class="k">count</span><span class="p">(</span><span class="k">type</span><span class="p">)</span> <span class="k">from</span> <span class="n">user_events</span> <span class="n">merge</span> <span class="n">admin_events</span> <span class="k">group</span> <span class="k">by</span> <span class="n">time</span><span class="p">(</span><span class="mi">10</span><span class="n">m</span><span class="p">)</span>
</pre>
<p>You&rsquo;d get a single time series with the count of events from the two combined in 10 minute intervals.</p>
<pre class="highlight sql"><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">merge</span> <span class="o">/</span><span class="n">stats</span><span class="p">.</span><span class="o">*/</span>
</pre>
<p>The above query would merge all of the stats time series into one.</p>

<h2>Joining Series</h2>

<p>Joins will put two or more series together. Since timestamps may not match exactly, InfluxDB will make a best effort to put points together. Joins are used when you want to perform a transformation of one time series against another. Here are a few examples.</p>
<pre class="highlight sql"><span class="k">select</span> <span class="n">hosta</span><span class="p">.</span><span class="n">value</span> <span class="o">+</span> <span class="n">hostb</span><span class="p">.</span><span class="n">value</span> 
<span class="k">from</span> <span class="n">cpu_load</span> <span class="k">as</span> <span class="n">hosta</span> 
<span class="k">inner</span> <span class="k">join</span> <span class="n">cpu_load</span> <span class="k">as</span> <span class="n">hostb</span> 
<span class="k">where</span> <span class="n">hosta</span><span class="p">.</span><span class="k">host</span> <span class="o">=</span> <span class="s1">&#39;hosta.influxdb.orb&#39;</span> <span class="k">and</span> <span class="n">hostb</span><span class="p">.</span><span class="k">host</span> <span class="o">=</span> <span class="s1">&#39;hostb.influxdb.org&#39;</span><span class="p">;</span>
</pre>
<p>The above query will return a time series of the combined cpu load for hosts a and b. The individual points will be coerced into the closest time frames to match up.</p>
<pre class="highlight sql"><span class="k">select</span> <span class="n">errors_per_minute</span><span class="p">.</span><span class="n">value</span> <span class="o">/</span> <span class="n">page_views_per_minute</span><span class="p">.</span><span class="n">value</span> 
<span class="k">from</span> <span class="n">errors_per_minute</span> 
<span class="k">inner</span> <span class="k">join</span> <span class="n">page_views_per_minute</span> 
</pre>
<p>The above query will return the error rate per minute.</p>
</div></div></section><script type="text/javascript">(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-45024174-1', 'influxdb.org');
ga('send', 'pageview');</script></body></html>
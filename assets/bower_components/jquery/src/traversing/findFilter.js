define(["../core","../var/indexOf","./var/rneedsContext","../selector"],function(t,e,n){function i(n,i,a){if(t.isFunction(i))return t.grep(n,function(t,e){return!!i.call(t,e,t)!==a});if(i.nodeType)return t.grep(n,function(t){return t===i!==a});if("string"==typeof i){if(s.test(i))return t.filter(i,n,a);i=t.filter(i,n)}return t.grep(n,function(t){return e.call(i,t)>=0!==a})}var s=/^.[^:#\[\.,]*$/;t.filter=function(e,n,i){var s=n[0];return i&&(e=":not("+e+")"),1===n.length&&1===s.nodeType?t.find.matchesSelector(s,e)?[s]:[]:t.find.matches(e,t.grep(n,function(t){return 1===t.nodeType}))},t.fn.extend({find:function(e){var n,i=this.length,s=[],a=this;if("string"!=typeof e)return this.pushStack(t(e).filter(function(){for(n=0;i>n;n++)if(t.contains(a[n],this))return!0}));for(n=0;i>n;n++)t.find(e,a[n],s);return s=this.pushStack(i>1?t.unique(s):s),s.selector=this.selector?this.selector+" "+e:e,s},filter:function(t){return this.pushStack(i(this,t||[],!1))},not:function(t){return this.pushStack(i(this,t||[],!0))},is:function(e){return!!i(this,"string"==typeof e&&n.test(e)?t(e):e||[],!1).length}})});
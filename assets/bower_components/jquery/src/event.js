define(["./core","./var/strundefined","./var/rnotwhite","./var/hasOwn","./var/slice","./event/support","./data/var/data_priv","./core/init","./data/accepts","./selector"],function(e,t,n,i,r,s,o){function a(){return!0}function c(){return!1}function u(){try{return document.activeElement}catch(e){}}var l=/^key/,d=/^(?:mouse|pointer|contextmenu)|click/,f=/^(?:focusinfocus|focusoutblur)$/,p=/^([^.]*)(?:\.(.+)|)$/;return e.event={global:{},add:function(i,r,s,a,c){var u,l,d,f,h,g,v,m,y,x,b,k=o.get(i);if(k)for(s.handler&&(u=s,s=u.handler,c=u.selector),s.guid||(s.guid=e.guid++),(f=k.events)||(f=k.events={}),(l=k.handle)||(l=k.handle=function(n){return typeof e!==t&&e.event.triggered!==n.type?e.event.dispatch.apply(i,arguments):void 0}),r=(r||"").match(n)||[""],h=r.length;h--;)d=p.exec(r[h])||[],y=b=d[1],x=(d[2]||"").split(".").sort(),y&&(v=e.event.special[y]||{},y=(c?v.delegateType:v.bindType)||y,v=e.event.special[y]||{},g=e.extend({type:y,origType:b,data:a,handler:s,guid:s.guid,selector:c,needsContext:c&&e.expr.match.needsContext.test(c),namespace:x.join(".")},u),(m=f[y])||(m=f[y]=[],m.delegateCount=0,v.setup&&v.setup.call(i,a,x,l)!==!1||i.addEventListener&&i.addEventListener(y,l,!1)),v.add&&(v.add.call(i,g),g.handler.guid||(g.handler.guid=s.guid)),c?m.splice(m.delegateCount++,0,g):m.push(g),e.event.global[y]=!0)},remove:function(t,i,r,s,a){var c,u,l,d,f,h,g,v,m,y,x,b=o.hasData(t)&&o.get(t);if(b&&(d=b.events)){for(i=(i||"").match(n)||[""],f=i.length;f--;)if(l=p.exec(i[f])||[],m=x=l[1],y=(l[2]||"").split(".").sort(),m){for(g=e.event.special[m]||{},m=(s?g.delegateType:g.bindType)||m,v=d[m]||[],l=l[2]&&new RegExp("(^|\\.)"+y.join("\\.(?:.*\\.|)")+"(\\.|$)"),u=c=v.length;c--;)h=v[c],!a&&x!==h.origType||r&&r.guid!==h.guid||l&&!l.test(h.namespace)||s&&s!==h.selector&&("**"!==s||!h.selector)||(v.splice(c,1),h.selector&&v.delegateCount--,g.remove&&g.remove.call(t,h));u&&!v.length&&(g.teardown&&g.teardown.call(t,y,b.handle)!==!1||e.removeEvent(t,m,b.handle),delete d[m])}else for(m in d)e.event.remove(t,m+i[f],r,s,!0);e.isEmptyObject(d)&&(delete b.handle,o.remove(t,"events"))}},trigger:function(t,n,r,s){var a,c,u,l,d,p,h,g=[r||document],v=i.call(t,"type")?t.type:t,m=i.call(t,"namespace")?t.namespace.split("."):[];if(c=u=r=r||document,3!==r.nodeType&&8!==r.nodeType&&!f.test(v+e.event.triggered)&&(v.indexOf(".")>=0&&(m=v.split("."),v=m.shift(),m.sort()),d=v.indexOf(":")<0&&"on"+v,t=t[e.expando]?t:new e.Event(v,"object"==typeof t&&t),t.isTrigger=s?2:3,t.namespace=m.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=r),n=null==n?[t]:e.makeArray(n,[t]),h=e.event.special[v]||{},s||!h.trigger||h.trigger.apply(r,n)!==!1)){if(!s&&!h.noBubble&&!e.isWindow(r)){for(l=h.delegateType||v,f.test(l+v)||(c=c.parentNode);c;c=c.parentNode)g.push(c),u=c;u===(r.ownerDocument||document)&&g.push(u.defaultView||u.parentWindow||window)}for(a=0;(c=g[a++])&&!t.isPropagationStopped();)t.type=a>1?l:h.bindType||v,p=(o.get(c,"events")||{})[t.type]&&o.get(c,"handle"),p&&p.apply(c,n),p=d&&c[d],p&&p.apply&&e.acceptData(c)&&(t.result=p.apply(c,n),t.result===!1&&t.preventDefault());return t.type=v,s||t.isDefaultPrevented()||h._default&&h._default.apply(g.pop(),n)!==!1||!e.acceptData(r)||d&&e.isFunction(r[v])&&!e.isWindow(r)&&(u=r[d],u&&(r[d]=null),e.event.triggered=v,r[v](),e.event.triggered=void 0,u&&(r[d]=u)),t.result}},dispatch:function(t){t=e.event.fix(t);var n,i,s,a,c,u=[],l=r.call(arguments),d=(o.get(this,"events")||{})[t.type]||[],f=e.event.special[t.type]||{};if(l[0]=t,t.delegateTarget=this,!f.preDispatch||f.preDispatch.call(this,t)!==!1){for(u=e.event.handlers.call(this,t,d),n=0;(a=u[n++])&&!t.isPropagationStopped();)for(t.currentTarget=a.elem,i=0;(c=a.handlers[i++])&&!t.isImmediatePropagationStopped();)(!t.namespace_re||t.namespace_re.test(c.namespace))&&(t.handleObj=c,t.data=c.data,s=((e.event.special[c.origType]||{}).handle||c.handler).apply(a.elem,l),void 0!==s&&(t.result=s)===!1&&(t.preventDefault(),t.stopPropagation()));return f.postDispatch&&f.postDispatch.call(this,t),t.result}},handlers:function(t,n){var i,r,s,o,a=[],c=n.delegateCount,u=t.target;if(c&&u.nodeType&&(!t.button||"click"!==t.type))for(;u!==this;u=u.parentNode||this)if(u.disabled!==!0||"click"!==t.type){for(r=[],i=0;c>i;i++)o=n[i],s=o.selector+" ",void 0===r[s]&&(r[s]=o.needsContext?e(s,this).index(u)>=0:e.find(s,this,null,[u]).length),r[s]&&r.push(o);r.length&&a.push({elem:u,handlers:r})}return c<n.length&&a.push({elem:this,handlers:n.slice(c)}),a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,i,r,s=t.button;return null==e.pageX&&null!=t.clientX&&(n=e.target.ownerDocument||document,i=n.documentElement,r=n.body,e.pageX=t.clientX+(i&&i.scrollLeft||r&&r.scrollLeft||0)-(i&&i.clientLeft||r&&r.clientLeft||0),e.pageY=t.clientY+(i&&i.scrollTop||r&&r.scrollTop||0)-(i&&i.clientTop||r&&r.clientTop||0)),e.which||void 0===s||(e.which=1&s?1:2&s?3:4&s?2:0),e}},fix:function(t){if(t[e.expando])return t;var n,i,r,s=t.type,o=t,a=this.fixHooks[s];for(a||(this.fixHooks[s]=a=d.test(s)?this.mouseHooks:l.test(s)?this.keyHooks:{}),r=a.props?this.props.concat(a.props):this.props,t=new e.Event(o),n=r.length;n--;)i=r[n],t[i]=o[i];return t.target||(t.target=document),3===t.target.nodeType&&(t.target=t.target.parentNode),a.filter?a.filter(t,o):t},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==u()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===u()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&e.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(t){return e.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(t,n,i,r){var s=e.extend(new e.Event,i,{type:t,isSimulated:!0,originalEvent:{}});r?e.event.trigger(s,null,n):e.event.dispatch.call(n,s),s.isDefaultPrevented()&&i.preventDefault()}},e.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},e.Event=function(t,n){return this instanceof e.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&t.returnValue===!1?a:c):this.type=t,n&&e.extend(this,n),this.timeStamp=t&&t.timeStamp||e.now(),this[e.expando]=!0,void 0):new e.Event(t,n)},e.Event.prototype={isDefaultPrevented:c,isPropagationStopped:c,isImmediatePropagationStopped:c,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=a,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=a,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=a,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},e.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,n){e.event.special[t]={delegateType:n,bindType:n,handle:function(t){var i,r=this,s=t.relatedTarget,o=t.handleObj;return(!s||s!==r&&!e.contains(r,s))&&(t.type=o.origType,i=o.handler.apply(this,arguments),t.type=n),i}}}),s.focusinBubbles||e.each({focus:"focusin",blur:"focusout"},function(t,n){var i=function(t){e.event.simulate(n,t.target,e.event.fix(t),!0)};e.event.special[n]={setup:function(){var e=this.ownerDocument||this,r=o.access(e,n);r||e.addEventListener(t,i,!0),o.access(e,n,(r||0)+1)},teardown:function(){var e=this.ownerDocument||this,r=o.access(e,n)-1;r?o.access(e,n,r):(e.removeEventListener(t,i,!0),o.remove(e,n))}}}),e.fn.extend({on:function(t,n,i,r,s){var o,a;if("object"==typeof t){"string"!=typeof n&&(i=i||n,n=void 0);for(a in t)this.on(a,n,i,t[a],s);return this}if(null==i&&null==r?(r=n,i=n=void 0):null==r&&("string"==typeof n?(r=i,i=void 0):(r=i,i=n,n=void 0)),r===!1)r=c;else if(!r)return this;return 1===s&&(o=r,r=function(t){return e().off(t),o.apply(this,arguments)},r.guid=o.guid||(o.guid=e.guid++)),this.each(function(){e.event.add(this,t,r,i,n)})},one:function(e,t,n,i){return this.on(e,t,n,i,1)},off:function(t,n,i){var r,s;if(t&&t.preventDefault&&t.handleObj)return r=t.handleObj,e(t.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof t){for(s in t)this.off(s,n,t[s]);return this}return(n===!1||"function"==typeof n)&&(i=n,n=void 0),i===!1&&(i=c),this.each(function(){e.event.remove(this,t,i,n)})},trigger:function(t,n){return this.each(function(){e.event.trigger(t,n,this)})},triggerHandler:function(t,n){var i=this[0];return i?e.event.trigger(t,n,i,!0):void 0}}),e});
define(["./core","./var/strundefined","./var/rnotwhite","./var/hasOwn","./var/slice","./event/support","./data/var/data_priv","./core/init","./data/accepts","./selector"],function(t,e,n,i,s,a,o){function r(){return!0}function l(){return!1}function c(){try{return document.activeElement}catch(t){}}var u=/^key/,d=/^(?:mouse|contextmenu)|click/,h=/^(?:focusinfocus|focusoutblur)$/,f=/^([^.]*)(?:\.(.+)|)$/;return t.event={global:{},add:function(i,s,a,r,l){var c,u,d,h,p,g,m,v,_,y,b,x=o.get(i);if(x)for(a.handler&&(c=a,a=c.handler,l=c.selector),a.guid||(a.guid=t.guid++),(h=x.events)||(h=x.events={}),(u=x.handle)||(u=x.handle=function(n){return typeof t!==e&&t.event.triggered!==n.type?t.event.dispatch.apply(i,arguments):void 0}),s=(s||"").match(n)||[""],p=s.length;p--;)d=f.exec(s[p])||[],_=b=d[1],y=(d[2]||"").split(".").sort(),_&&(m=t.event.special[_]||{},_=(l?m.delegateType:m.bindType)||_,m=t.event.special[_]||{},g=t.extend({type:_,origType:b,data:r,handler:a,guid:a.guid,selector:l,needsContext:l&&t.expr.match.needsContext.test(l),namespace:y.join(".")},c),(v=h[_])||(v=h[_]=[],v.delegateCount=0,m.setup&&m.setup.call(i,r,y,u)!==!1||i.addEventListener&&i.addEventListener(_,u,!1)),m.add&&(m.add.call(i,g),g.handler.guid||(g.handler.guid=a.guid)),l?v.splice(v.delegateCount++,0,g):v.push(g),t.event.global[_]=!0)},remove:function(e,i,s,a,r){var l,c,u,d,h,p,g,m,v,_,y,b=o.hasData(e)&&o.get(e);if(b&&(d=b.events)){for(i=(i||"").match(n)||[""],h=i.length;h--;)if(u=f.exec(i[h])||[],v=y=u[1],_=(u[2]||"").split(".").sort(),v){for(g=t.event.special[v]||{},v=(a?g.delegateType:g.bindType)||v,m=d[v]||[],u=u[2]&&new RegExp("(^|\\.)"+_.join("\\.(?:.*\\.|)")+"(\\.|$)"),c=l=m.length;l--;)p=m[l],!r&&y!==p.origType||s&&s.guid!==p.guid||u&&!u.test(p.namespace)||a&&a!==p.selector&&("**"!==a||!p.selector)||(m.splice(l,1),p.selector&&m.delegateCount--,g.remove&&g.remove.call(e,p));c&&!m.length&&(g.teardown&&g.teardown.call(e,_,b.handle)!==!1||t.removeEvent(e,v,b.handle),delete d[v])}else for(v in d)t.event.remove(e,v+i[h],s,a,!0);t.isEmptyObject(d)&&(delete b.handle,o.remove(e,"events"))}},trigger:function(e,n,s,a){var r,l,c,u,d,f,p,g=[s||document],m=i.call(e,"type")?e.type:e,v=i.call(e,"namespace")?e.namespace.split("."):[];if(l=c=s=s||document,3!==s.nodeType&&8!==s.nodeType&&!h.test(m+t.event.triggered)&&(m.indexOf(".")>=0&&(v=m.split("."),m=v.shift(),v.sort()),d=m.indexOf(":")<0&&"on"+m,e=e[t.expando]?e:new t.Event(m,"object"==typeof e&&e),e.isTrigger=a?2:3,e.namespace=v.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=s),n=null==n?[e]:t.makeArray(n,[e]),p=t.event.special[m]||{},a||!p.trigger||p.trigger.apply(s,n)!==!1)){if(!a&&!p.noBubble&&!t.isWindow(s)){for(u=p.delegateType||m,h.test(u+m)||(l=l.parentNode);l;l=l.parentNode)g.push(l),c=l;c===(s.ownerDocument||document)&&g.push(c.defaultView||c.parentWindow||window)}for(r=0;(l=g[r++])&&!e.isPropagationStopped();)e.type=r>1?u:p.bindType||m,f=(o.get(l,"events")||{})[e.type]&&o.get(l,"handle"),f&&f.apply(l,n),f=d&&l[d],f&&f.apply&&t.acceptData(l)&&(e.result=f.apply(l,n),e.result===!1&&e.preventDefault());return e.type=m,a||e.isDefaultPrevented()||p._default&&p._default.apply(g.pop(),n)!==!1||!t.acceptData(s)||d&&t.isFunction(s[m])&&!t.isWindow(s)&&(c=s[d],c&&(s[d]=null),t.event.triggered=m,s[m](),t.event.triggered=void 0,c&&(s[d]=c)),e.result}},dispatch:function(e){e=t.event.fix(e);var n,i,a,r,l,c=[],u=s.call(arguments),d=(o.get(this,"events")||{})[e.type]||[],h=t.event.special[e.type]||{};if(u[0]=e,e.delegateTarget=this,!h.preDispatch||h.preDispatch.call(this,e)!==!1){for(c=t.event.handlers.call(this,e,d),n=0;(r=c[n++])&&!e.isPropagationStopped();)for(e.currentTarget=r.elem,i=0;(l=r.handlers[i++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(l.namespace))&&(e.handleObj=l,e.data=l.data,a=((t.event.special[l.origType]||{}).handle||l.handler).apply(r.elem,u),void 0!==a&&(e.result=a)===!1&&(e.preventDefault(),e.stopPropagation()));return h.postDispatch&&h.postDispatch.call(this,e),e.result}},handlers:function(e,n){var i,s,a,o,r=[],l=n.delegateCount,c=e.target;if(l&&c.nodeType&&(!e.button||"click"!==e.type))for(;c!==this;c=c.parentNode||this)if(c.disabled!==!0||"click"!==e.type){for(s=[],i=0;l>i;i++)o=n[i],a=o.selector+" ",void 0===s[a]&&(s[a]=o.needsContext?t(a,this).index(c)>=0:t.find(a,this,null,[c]).length),s[a]&&s.push(o);s.length&&r.push({elem:c,handlers:s})}return l<n.length&&r.push({elem:this,handlers:n.slice(l)}),r},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var n,i,s,a=e.button;return null==t.pageX&&null!=e.clientX&&(n=t.target.ownerDocument||document,i=n.documentElement,s=n.body,t.pageX=e.clientX+(i&&i.scrollLeft||s&&s.scrollLeft||0)-(i&&i.clientLeft||s&&s.clientLeft||0),t.pageY=e.clientY+(i&&i.scrollTop||s&&s.scrollTop||0)-(i&&i.clientTop||s&&s.clientTop||0)),t.which||void 0===a||(t.which=1&a?1:2&a?3:4&a?2:0),t}},fix:function(e){if(e[t.expando])return e;var n,i,s,a=e.type,o=e,r=this.fixHooks[a];for(r||(this.fixHooks[a]=r=d.test(a)?this.mouseHooks:u.test(a)?this.keyHooks:{}),s=r.props?this.props.concat(r.props):this.props,e=new t.Event(o),n=s.length;n--;)i=s[n],e[i]=o[i];return e.target||(e.target=document),3===e.target.nodeType&&(e.target=e.target.parentNode),r.filter?r.filter(e,o):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==c()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===c()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&t.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(e){return t.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&(t.originalEvent.returnValue=t.result)}}},simulate:function(e,n,i,s){var a=t.extend(new t.Event,i,{type:e,isSimulated:!0,originalEvent:{}});s?t.event.trigger(a,null,n):t.event.dispatch.call(n,a),a.isDefaultPrevented()&&i.preventDefault()}},t.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n,!1)},t.Event=function(e,n){return this instanceof t.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.getPreventDefault&&e.getPreventDefault()?r:l):this.type=e,n&&t.extend(this,n),this.timeStamp=e&&e.timeStamp||t.now(),this[t.expando]=!0,void 0):new t.Event(e,n)},t.Event.prototype={isDefaultPrevented:l,isPropagationStopped:l,isImmediatePropagationStopped:l,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=r,t&&t.preventDefault&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=r,t&&t.stopPropagation&&t.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=r,this.stopPropagation()}},t.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,n){t.event.special[e]={delegateType:n,bindType:n,handle:function(e){var i,s=this,a=e.relatedTarget,o=e.handleObj;return(!a||a!==s&&!t.contains(s,a))&&(e.type=o.origType,i=o.handler.apply(this,arguments),e.type=n),i}}}),a.focusinBubbles||t.each({focus:"focusin",blur:"focusout"},function(e,n){var i=function(e){t.event.simulate(n,e.target,t.event.fix(e),!0)};t.event.special[n]={setup:function(){var t=this.ownerDocument||this,s=o.access(t,n);s||t.addEventListener(e,i,!0),o.access(t,n,(s||0)+1)},teardown:function(){var t=this.ownerDocument||this,s=o.access(t,n)-1;s?o.access(t,n,s):(t.removeEventListener(e,i,!0),o.remove(t,n))}}}),t.fn.extend({on:function(e,n,i,s,a){var o,r;if("object"==typeof e){"string"!=typeof n&&(i=i||n,n=void 0);for(r in e)this.on(r,n,i,e[r],a);return this}if(null==i&&null==s?(s=n,i=n=void 0):null==s&&("string"==typeof n?(s=i,i=void 0):(s=i,i=n,n=void 0)),s===!1)s=l;else if(!s)return this;return 1===a&&(o=s,s=function(e){return t().off(e),o.apply(this,arguments)},s.guid=o.guid||(o.guid=t.guid++)),this.each(function(){t.event.add(this,e,s,i,n)})},one:function(t,e,n,i){return this.on(t,e,n,i,1)},off:function(e,n,i){var s,a;if(e&&e.preventDefault&&e.handleObj)return s=e.handleObj,t(e.delegateTarget).off(s.namespace?s.origType+"."+s.namespace:s.origType,s.selector,s.handler),this;if("object"==typeof e){for(a in e)this.off(a,n,e[a]);return this}return(n===!1||"function"==typeof n)&&(i=n,n=void 0),i===!1&&(i=l),this.each(function(){t.event.remove(this,e,i,n)})},trigger:function(e,n){return this.each(function(){t.event.trigger(e,n,this)})},triggerHandler:function(e,n){var i=this[0];return i?t.event.trigger(e,n,i,!0):void 0}}),t});
define(["../core","./var/nonce","./var/rquery","../ajax"],function(t,e,n){var i=[],r=/(=)\?(?=&|$)|\?\?/;t.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var n=i.pop()||t.expando+"_"+e++;return this[n]=!0,n}}),t.ajaxPrefilter("json jsonp",function(e,o,s){var a,c,u,l=e.jsonp!==!1&&(r.test(e.url)?"url":"string"==typeof e.data&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&r.test(e.data)&&"data");return l||"jsonp"===e.dataTypes[0]?(a=e.jsonpCallback=t.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,l?e[l]=e[l].replace(r,"$1"+a):e.jsonp!==!1&&(e.url+=(n.test(e.url)?"&":"?")+e.jsonp+"="+a),e.converters["script json"]=function(){return u||t.error(a+" was not called"),u[0]},e.dataTypes[0]="json",c=window[a],window[a]=function(){u=arguments},s.always(function(){window[a]=c,e[a]&&(e.jsonpCallback=o.jsonpCallback,i.push(a)),u&&t.isFunction(c)&&c(u[0]),u=c=void 0}),"script"):void 0})});
define(["../core","./var/nonce","./var/rquery","../ajax"],function(t,e,n){var i=[],s=/(=)\?(?=&|$)|\?\?/;t.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var n=i.pop()||t.expando+"_"+e++;return this[n]=!0,n}}),t.ajaxPrefilter("json jsonp",function(e,a,o){var r,l,c,u=e.jsonp!==!1&&(s.test(e.url)?"url":"string"==typeof e.data&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&s.test(e.data)&&"data");return u||"jsonp"===e.dataTypes[0]?(r=e.jsonpCallback=t.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,u?e[u]=e[u].replace(s,"$1"+r):e.jsonp!==!1&&(e.url+=(n.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return c||t.error(r+" was not called"),c[0]},e.dataTypes[0]="json",l=window[r],window[r]=function(){c=arguments},o.always(function(){window[r]=l,e[r]&&(e.jsonpCallback=a.jsonpCallback,i.push(r)),c&&t.isFunction(l)&&l(c[0]),c=l=void 0}),"script"):void 0})});
define(["../core","../var/support","../ajax"],function(t,e){t.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(t){}};var n=0,i={},s={0:200,1223:204},r=t.ajaxSettings.xhr();window.attachEvent&&window.attachEvent("onunload",function(){for(var t in i)i[t]()}),e.cors=!!r&&"withCredentials"in r,e.ajax=r=!!r,t.ajaxTransport(function(t){var a;return e.cors||r&&!t.crossDomain?{send:function(e,r){var o,l=t.xhr(),c=++n;if(l.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(o in t.xhrFields)l[o]=t.xhrFields[o];t.mimeType&&l.overrideMimeType&&l.overrideMimeType(t.mimeType),t.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");for(o in e)l.setRequestHeader(o,e[o]);a=function(t){return function(){a&&(delete i[c],a=l.onload=l.onerror=null,"abort"===t?l.abort():"error"===t?r(l.status,l.statusText):r(s[l.status]||l.status,l.statusText,"string"==typeof l.responseText?{text:l.responseText}:void 0,l.getAllResponseHeaders()))}},l.onload=a(),l.onerror=a("error"),a=i[c]=a("abort");try{l.send(t.hasContent&&t.data||null)}catch(u){if(a)throw u}},abort:function(){a&&a()}}:void 0})});
define(["../core","../var/support","../ajax"],function(t,e){t.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(t){}};var n=0,i={},s={0:200,1223:204},r=t.ajaxSettings.xhr();window.ActiveXObject&&t(window).on("unload",function(){for(var t in i)i[t]()}),e.cors=!!r&&"withCredentials"in r,e.ajax=r=!!r,t.ajaxTransport(function(t){var o;return e.cors||r&&!t.crossDomain?{send:function(e,r){var a,c=t.xhr(),l=++n;if(c.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(a in t.xhrFields)c[a]=t.xhrFields[a];t.mimeType&&c.overrideMimeType&&c.overrideMimeType(t.mimeType),t.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");for(a in e)c.setRequestHeader(a,e[a]);o=function(t){return function(){o&&(delete i[l],o=c.onload=c.onerror=null,"abort"===t?c.abort():"error"===t?r(c.status,c.statusText):r(s[c.status]||c.status,c.statusText,"string"==typeof c.responseText?{text:c.responseText}:void 0,c.getAllResponseHeaders()))}},c.onload=o(),c.onerror=o("error"),o=i[l]=o("abort"),c.send(t.hasContent&&t.data||null)},abort:function(){o&&o()}}:void 0})});
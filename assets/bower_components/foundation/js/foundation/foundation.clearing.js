!function(e,t,n,i){"use strict";Foundation.libs.clearing={name:"clearing",version:"5.1.1",settings:{templates:{viewing:'<a href="#" class="clearing-close">&times;</a><div class="visible-img" style="display: none"><div class="clearing-touch-label"></div><img src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D" alt="" /><p class="clearing-caption"></p><a href="#" class="clearing-main-prev"><span></span></a><a href="#" class="clearing-main-next"><span></span></a></div>'},close_selectors:".clearing-close",touch_label:"&larr;&nbsp;Swipe to Advance&nbsp;&rarr;",init:!1,locked:!1},init:function(e,t,n){var i=this;Foundation.inherit(this,"throttle image_loaded"),this.bindings(t,n),i.S(this.scope).is("["+this.attr_name()+"]")?this.assemble(i.S("li",this.scope)):i.S("["+this.attr_name()+"]",this.scope).each(function(){i.assemble(i.S("li",this))})},events:function(e){var n=this,i=n.S;i(this.scope).off(".clearing").on("click.fndtn.clearing","ul["+this.attr_name()+"] li",function(e,t,r){var t=t||i(this),r=r||t,o=t.next("li"),s=t.closest("["+n.attr_name()+"]").data(n.attr_name(!0)+"-init"),a=i(e.target);e.preventDefault(),s||(n.init(),s=t.closest("["+n.attr_name()+"]").data(n.attr_name(!0)+"-init")),r.hasClass("visible")&&t[0]===r[0]&&o.length>0&&n.is_open(t)&&(r=o,a=i("img",r)),n.open(a,t,r),n.update_paddles(r)}).on("click.fndtn.clearing",".clearing-main-next",function(e){n.nav(e,"next")}).on("click.fndtn.clearing",".clearing-main-prev",function(e){n.nav(e,"prev")}).on("click.fndtn.clearing",this.settings.close_selectors,function(e){Foundation.libs.clearing.close(e,this)}).on("keydown.fndtn.clearing",function(e){n.keydown(e)}),i(t).off(".clearing").on("resize.fndtn.clearing",function(){n.resize()}),this.swipe_events(e)},swipe_events:function(){var e=this,t=e.S;t(this.scope).on("touchstart.fndtn.clearing",".visible-img",function(e){e.touches||(e=e.originalEvent);var n={start_page_x:e.touches[0].pageX,start_page_y:e.touches[0].pageY,start_time:(new Date).getTime(),delta_x:0,is_scrolling:i};t(this).data("swipe-transition",n),e.stopPropagation()}).on("touchmove.fndtn.clearing",".visible-img",function(n){if(n.touches||(n=n.originalEvent),!(n.touches.length>1||n.scale&&1!==n.scale)){var i=t(this).data("swipe-transition");if("undefined"==typeof i&&(i={}),i.delta_x=n.touches[0].pageX-i.start_page_x,"undefined"==typeof i.is_scrolling&&(i.is_scrolling=!!(i.is_scrolling||Math.abs(i.delta_x)<Math.abs(n.touches[0].pageY-i.start_page_y))),!i.is_scrolling&&!i.active){n.preventDefault();var r=i.delta_x<0?"next":"prev";i.active=!0,e.nav(n,r)}}}).on("touchend.fndtn.clearing",".visible-img",function(e){t(this).data("swipe-transition",{}),e.stopPropagation()})},assemble:function(t){var n=t.parent();if(!n.parent().hasClass("carousel")){n.after('<div id="foundationClearingHolder"></div>');var i=this.S("#foundationClearingHolder"),r=n.data(this.attr_name(!0)+"-init"),o=n.detach(),s={grid:'<div class="carousel">'+o[0].outerHTML+"</div>",viewing:r.templates.viewing},a='<div class="clearing-assembled"><div>'+s.viewing+s.grid+"</div></div>",l=this.settings.touch_label;Modernizr.touch&&(a=e(a).find(".clearing-touch-label").html(l).end()),i.after(a).remove()}},open:function(e,t,n){var i=this,r=n.closest(".clearing-assembled"),o=i.S("div",r).first(),s=i.S(".visible-img",o),a=i.S("img",s).not(e),l=i.S(".clearing-touch-label",o);this.locked()||(a.attr("src",this.load(e)).css("visibility","hidden"),this.image_loaded(a,function(){a.css("visibility","visible"),r.addClass("clearing-blackout"),o.addClass("clearing-container"),s.show(),this.fix_height(n).caption(i.S(".clearing-caption",s),e).center_and_label(a,l).shift(t,n,function(){n.siblings().removeClass("visible"),n.addClass("visible")})}.bind(this)))},close:function(t,n){t.preventDefault();var i,r,o=function(e){return/blackout/.test(e.selector)?e:e.closest(".clearing-blackout")}(e(n));return n===t.target&&o&&(i=e("div",o).first(),r=e(".visible-img",i),this.settings.prev_index=0,e("ul["+this.attr_name()+"]",o).attr("style","").closest(".clearing-blackout").removeClass("clearing-blackout"),i.removeClass("clearing-container"),r.hide()),!1},is_open:function(e){return e.parent().prop("style").length>0},keydown:function(t){var n=e("ul["+this.attr_name()+"]",".clearing-blackout"),i=this.rtl?37:39,r=this.rtl?39:37,o=27;t.which===i&&this.go(n,"next"),t.which===r&&this.go(n,"prev"),t.which===o&&this.S("a.clearing-close").trigger("click")},nav:function(t,n){var i=e("ul["+this.attr_name()+"]",".clearing-blackout");t.preventDefault(),this.go(i,n)},resize:function(){var t=e("img",".clearing-blackout .visible-img"),n=e(".clearing-touch-label",".clearing-blackout");t.length&&this.center_and_label(t,n)},fix_height:function(e){var t=e.parent().children(),n=this;return t.each(function(){var e=n.S(this),t=e.find("img");e.height()>t.outerHeight()&&e.addClass("fix-height")}).closest("ul").width(100*t.length+"%"),this},update_paddles:function(e){var t=e.closest(".carousel").siblings(".visible-img");e.next().length>0?this.S(".clearing-main-next",t).removeClass("disabled"):this.S(".clearing-main-next",t).addClass("disabled"),e.prev().length>0?this.S(".clearing-main-prev",t).removeClass("disabled"):this.S(".clearing-main-prev",t).addClass("disabled")},center_and_label:function(e,t){return this.rtl?(e.css({marginRight:-(e.outerWidth()/2),marginTop:-(e.outerHeight()/2),left:"auto",right:"50%"}),t.css({marginRight:-(t.outerWidth()/2),marginTop:-(e.outerHeight()/2)-t.outerHeight()-10,left:"auto",right:"50%"})):(e.css({marginLeft:-(e.outerWidth()/2),marginTop:-(e.outerHeight()/2)}),t.css({marginLeft:-(t.outerWidth()/2),marginTop:-(e.outerHeight()/2)-t.outerHeight()-10})),this},load:function(e){if("A"===e[0].nodeName)var t=e.attr("href");else var t=e.parent().attr("href");return this.preload(e),t?t:e.attr("src")},preload:function(e){this.img(e.closest("li").next()).img(e.closest("li").prev())},img:function(e){if(e.length){var t=new Image,n=this.S("a",e);t.src=n.length?n.attr("href"):this.S("img",e).attr("src")}return this},caption:function(e,t){var n=t.data("caption");return n?e.html(n).show():e.text("").hide(),this},go:function(e,t){var n=this.S(".visible",e),i=n[t]();i.length&&this.S("img",i).trigger("click",[n,i])},shift:function(e,t,n){var i,r=t.parent(),o=this.settings.prev_index||t.index(),s=this.direction(r,e,t),a=this.rtl?"right":"left",l=parseInt(r.css("left"),10),c=t.outerWidth(),u={};t.index()===o||/skip/.test(s)?/skip/.test(s)&&(i=t.index()-this.settings.up_count,this.lock(),i>0?(u[a]=-(i*c),r.animate(u,300,this.unlock())):(u[a]=0,r.animate(u,300,this.unlock()))):/left/.test(s)?(this.lock(),u[a]=l+c,r.animate(u,300,this.unlock())):/right/.test(s)&&(this.lock(),u[a]=l-c,r.animate(u,300,this.unlock())),n()},direction:function(e,t,n){var i,r=this.S("li",e),o=r.outerWidth()+r.outerWidth()/4,s=Math.floor(this.S(".clearing-container").outerWidth()/o)-1,a=r.index(n);return this.settings.up_count=s,i=this.adjacent(this.settings.prev_index,a)?a>s&&a>this.settings.prev_index?"right":a>s-1&&a<=this.settings.prev_index?"left":!1:"skip",this.settings.prev_index=a,i},adjacent:function(e,t){for(var n=t+1;n>=t-1;n--)if(n===e)return!0;return!1},lock:function(){this.settings.locked=!0},unlock:function(){this.settings.locked=!1},locked:function(){return this.settings.locked},off:function(){this.S(this.scope).off(".fndtn.clearing"),this.S(t).off(".fndtn.clearing")},reflow:function(){this.init()}}}(jQuery,this,this.document);